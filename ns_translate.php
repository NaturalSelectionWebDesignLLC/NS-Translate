<?php/*** @version        v3.0* @package        Joomla!®* @copyright      Copyright © 2011 Natural Selection Web Design LLC.* @support        http://nsel.co* @license        GNU/GPL, see license.txt*/// no direct accessdefined( '_JEXEC' ) or die( 'Restricted access' );jimport( 'joomla.plugin.plugin' );class plgSystemNS_Translate extends JPlugin{        var $p_type = '';    var $p_name = '';        function plgNS_Translate( &$subject, $params ){        $this->p_type = $params['type'];        $this->p_name = $params['name'];        parent::__construct( $subject, $params );    }        function onAfterRender(){        $mainframe = JFactory::getApplication();                if($mainframe->isAdmin()){            return true;        }                ob_start();                if($this->params->get('gts') == '1'){            $position = ($this->params->get('gts_position')==1)?"left":"right";            $side_distance = $this->params->get('gts_lr');            $top_distance = $this->params->get('gts_top');                        $style_tab = $position.":".$side_distance.";top:".$top_distance.";";            $background = ($position=="left")?"'plugins/system/ns_translate/assets/images/gts_tab_l.png' ":"'plugins/system/ns_translate/assets/images/gts_tab_r.png' ";            $style_box = $position.":".(intval($side_distance)+6)."px;top:".$top_distance.";";        }                ?>        <div id="gts_wrap">            <div class="gts_tab" style="<?php echo $style_tab; ?>"></div>            <div id="gts_box" class="gts_box" style="<?php echo $style_box; ?>display: none">                <div id="google_translate_element" style="padding:10px;"></div>                <script>                    function googleTranslateElementInit() {                      new google.translate.TranslateElement({                        pageLanguage: 'en'                      }, 'google_translate_element');                    }                </script>                <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>                    </div>        </div>        <?php                $str_html = ob_get_contents();        ob_end_clean();                ob_start();        ?>        <script type="text/javascript">            function gts_show_translate() {                document.getElementById("gts_box").style.display = "block";            }                        function gts_hide_translate() {                document.getElementById("gts_box").style.display = "none";            }                        window.addEvent('domready',function(){                var gts_wrap = $('gts_wrap');                                gts_wrap.addEvent('mouseover',function(){                        gts_show_translate();                        if (Browser.ie){                            $$('select.goog-te-combo').addEvent(                                                 'click',function(){                                    $('gts_wrap').removeEvent('mouseleave',gts_hide_translate);                                    }                            );                                                        $$('select.goog-te-combo').addEvent(                                                 'change',function(){                                    gts_hide_translate();                                      $('gts_wrap').addEvent('mouseleave',gts_hide_translate);                                   }                            );                                                        $$('select.goog-te-combo').addEvent(                                                 'blur',function(){                                    gts_hide_translate();                                      $('gts_wrap').addEvent('mouseleave',gts_hide_translate);                                   }                            );                        }                           });                 gts_wrap.addEvent('mouseleave',gts_hide_translate);                             });                    </script>        <style type="text/css">            .gts_tab{                position:fixed;                width: 39px;                height: 140px;                  cursor: pointer;                background: url(<?php echo $background; ?>) no-repeat;                          }            .gts_tab_bg_none{                background: none;               }            .gts_box{                position:fixed;                width: 240px;                background: white;                 border-radius: 8px ;                height: 140px;            }        </style>        <?php        $str_jsncss = ob_get_contents();        ob_end_clean();        $body = JResponse::getBody();        $body = str_replace('</head>',$str_jsncss.'</head>',$body);        $body = str_replace('</body>', $str_html.'</body>', $body);        JResponse::setBody($body);                return true;    }    }